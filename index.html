<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EducaFlow Pro - Sistema Completo de Gest√£o Escolar</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Integra√ß√£o de IA: TensorFlow.js e modelo de toxicidade -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/toxicity@1.2.2/dist/toxicity.min.js"></script>
    <!-- Biblioteca para captura de screenshots de elementos (exporta√ß√£o de heatmap) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash" class="splash">
        <div class="splash__content">
            <div class="splash__logo">
                <h1>EducaFlow Pro</h1>
                <p>Sistema Completo</p>
            </div>
            <div class="splash__loading">
                <div class="spinner"></div>
                <p id="loadingStatus">Inicializando sistema...</p>
            </div>
            <!-- A lista de verifica√ß√µes do sistema fica vis√≠vel por padr√£o para
                 permitir que a l√≥gica de inicializa√ß√£o atualize os √≠cones e
                 mensagens. -->
            <div id="systemChecks" class="system-checks">
                <div class="check-item" id="check-firebase">
                    <span class="check-status">‚è≥</span> Firebase Database
                </div>
                <div class="check-item" id="check-auth">
                    <span class="check-status">‚è≥</span> Autentica√ß√£o Google
                </div>
                <div class="check-item" id="check-connection">
                    <span class="check-status">‚è≥</span> Conectividade
                </div>
                <div class="check-item" id="check-domains">
                    <span class="check-status">‚è≥</span> Dom√≠nios Autorizados
                </div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login" class="login hidden">
        <div class="login__container">
            <div class="login__header">
                <div class="logo-container">
                    <!-- O src ser√° preenchido dinamicamente pelo JavaScript para garantir que o logotipo sempre carregue. -->
                    <!-- A imagem do logotipo ser√° definida via JavaScript usando
                         dados Base64 para evitar problemas de carregamento de
                         arquivos est√°ticos em diferentes dom√≠nios. -->
                    <img class="logo-img" alt="Logo EducaFlow Pro">
                    <div class="logo-text">
                        <h1>EducaFlow Pro</h1>
                        <p class="tagline">Transformando a disciplina em excel√™ncia</p>
                    </div>
                </div>
                <p>Sistema Completo de Gest√£o Escolar</p>
                <span class="version">v2.0</span>
            </div>
            <div class="login__content">
                <h2>Fa√ßa login para continuar</h2>
                <p>Acesse o sistema com sua conta Google</p>
                <button id="googleLoginBtn" class="btn btn--primary btn--google" disabled>
                    <svg width="18" height="18" viewBox="0 0 18 18">
                        <path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"/>
                        <path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2.04a4.8 4.8 0 0 1-2.7.75c-2.087 0-3.85-1.41-4.48-3.31H1.96v2.06A8 8 0 0 0 8.98 17z"/>
                        <path fill="#FBBC05" d="M4.5 10.75a4.8 4.8 0 0 1 0-3.5V5.19H1.96a8 8 0 0 0 0 7.12l2.54-1.56z"/>
                        <path fill="#EA4335" d="M8.98 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 8.98 0A8 8 0 0 0 1.96 5.19L4.5 7.25c.63-1.9 2.393-3.32 4.48-3.32z"/>
                    </svg>
                    Entrar com Google
                </button>
                <!-- Removido bot√£o de Modo Demo para utilizar somente o modo online -->
                <div id="loginError" class="login__error hidden">
                    <p>Erro ao fazer login. Tente novamente.</p>
                </div>
                <div id="loginLoading" class="login__loading hidden">
                    <div class="spinner small"></div>
                    <p>Fazendo login...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="dashboard hidden">
        <!-- Header -->
        <header class="dashboard__header">
            <div class="header__left">
                <div class="logo-container">
                     <!-- O src ser√° preenchido dinamicamente pelo JavaScript -->
                     <img class="logo-img" alt="Logo EducaFlow Pro">
                    <div class="logo-text">
                        <h1>EducaFlow Pro</h1>
                        <p class="tagline">Transformando a disciplina em excel√™ncia</p>
                    </div>
                </div>
                <span class="version">v2.0</span>
                <div id="demoIndicator" class="demo-indicator hidden">
                    <span>üé≠ MODO DEMO</span>
                </div>
            </div>
            <div class="header__right">
                <div class="user-info">
                    <img id="userPhoto" class="user-photo" src="" alt="Foto de usu√°rio">
                    <span id="userName"></span>
                </div>
                <button id="logoutBtn" class="btn btn--outline btn--sm">Sair</button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="dashboard__nav">
            <button class="nav-btn active" data-tab="overview">üìä Dashboard</button>
            <button class="nav-btn" data-tab="students">üë• Alunos</button>
            <button class="nav-btn" data-tab="classes">üè´ Turmas</button>
            <button class="nav-btn" data-tab="infractions">‚öñÔ∏è Infra√ß√µes</button>
            <button class="nav-btn" data-tab="filters">üîç Filtros</button>
            <!-- Removed separate Statistics button; the dashboard now includes statistics -->
            <!-- <button class="nav-btn" data-tab="statistics">üìä Estat√≠sticas</button> -->
            <button class="nav-btn" data-tab="reports">üìã Relat√≥rios</button>
            <!-- Bot√£o de Configura√ß√µes (vis√≠vel apenas para administradores) -->
            <button class="nav-btn" id="settingsNavBtn" data-tab="settings">‚öôÔ∏è Configura√ß√µes</button>
        </nav>

        <!-- Content Area -->
        <main class="dashboard__content">
            <!-- Overview Tab -->
            <div id="tab-overview" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card" data-action="students">
                        <h3>Total de Alunos</h3>
                        <div class="stat-value" id="totalStudents">-</div>
                    </div>
                    <div class="stat-card" data-action="classes">
                        <h3>Turmas Ativas</h3>
                        <div class="stat-value" id="totalClasses">-</div>
                    </div>
                    <div class="stat-card" data-action="infractions">
                        <h3>Infra√ß√µes (M√™s)</h3>
                        <div class="stat-value" id="monthInfractions">-</div>
                    </div>
                    <div class="stat-card" data-action="reports">
                        <h3>Relat√≥rios Gerados</h3>
                        <div class="stat-value" id="totalReports">-</div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container" style="position: relative; height: 350px;">
                        <h3>Infra√ß√µes por M√™s</h3>
                        <canvas id="infractionChart"></canvas>
                    </div>
                    <div class="chart-container" style="position: relative; height: 350px;">
                        <h3>Tipos de Infra√ß√µes</h3>
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>

                <!-- Estat√≠sticas Avan√ßadas - agora dentro do Dashboard -->
                <div class="advanced-stats">
                    <div class="section-header">
                        <h2>üìä Estat√≠sticas Gerais e An√°lises</h2>
                        <p>An√°lise completa com visualiza√ß√µes avan√ßadas e indicadores</p>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>üìà Gr√°fico de Tend√™ncias</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="trendsChart"></canvas>
                            </div>
                            <button onclick="exportChart('trendsChart')" class="btn btn--sm btn--outline">üíæ Exportar</button>
                        </div>
                        <div class="stat-card">
                            <h3>üó∫Ô∏è Mapa de Calor - Hor√°rios</h3>
                            <div id="heatmapHours" class="heatmap-container"></div>
                            <button onclick="exportHeatmap('hours')" class="btn btn--sm btn--outline">üíæ Exportar</button>
                        </div>
                        <div class="stat-card">
                            <h3>üè´ Mapa de Calor - Turmas</h3>
                            <div id="heatmapClasses" class="heatmap-container"></div>
                            <button onclick="exportHeatmap('classes')" class="btn btn--sm btn--outline">üíæ Exportar</button>
                        </div>
                        <div class="stat-card">
                            <h3>üìä An√°lise Comparativa</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="comparativeChart"></canvas>
                            </div>
                            <button onclick="exportChart('comparativeChart')" class="btn btn--sm btn--outline">üíæ Exportar</button>
                        </div>
                        <div class="stat-card">
                            <h3>üéØ KPIs Educacionais</h3>
                            <div class="kpi-grid">
                                <div class="kpi-item">
                                    <span class="kpi-value" id="disciplineIndex">87%</span>
                                    <span class="kpi-label">√çndice de Disciplina</span>
                                </div>
                                <div class="kpi-item">
                                    <span class="kpi-value" id="improvementRate">76%</span>
                                    <span class="kpi-label">Taxa de Melhoria</span>
                                </div>
                                <div class="kpi-item">
                                    <span class="kpi-value" id="parentEngagement">92%</span>
                                    <span class="kpi-label">Engajamento Familiar</span>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <h3>üìÖ Calend√°rio de Eventos</h3>
                            <div id="eventsCalendar" class="calendar-container">
                                <div class="calendar-grid">
                                    <div class="calendar-day">
                                        <span class="day-number">07</span>
                                        <span class="day-events">3 infra√ß√µes</span>
                                    </div>
                                    <div class="calendar-day">
                                        <span class="day-number">08</span>
                                        <span class="day-events">2 infra√ß√µes</span>
                                    </div>
                                    <div class="calendar-day">
                                        <span class="day-number">09</span>
                                        <span class="day-events">1 infra√ß√£o</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-actions">
                        <button onclick="generateFullReport()" class="btn btn--primary">üìã Relat√≥rio Completo</button>
                        <button onclick="scheduleReport()" class="btn btn--info">‚è∞ Agendar Relat√≥rio</button>
                        <button onclick="exportAllStats()" class="btn btn--success">üìä Exportar Todas</button>
                        <button onclick="printDashboard()" class="btn btn--secondary">üñ®Ô∏è Imprimir Dashboard</button>
                    </div>
                </div>
            </div>

            <!-- Students Tab -->
            <div id="tab-students" class="tab-content">
                <div class="content-header">
                    <h2>Gest√£o de Alunos</h2>
                    <button class="btn btn--primary" id="addStudentBtn">‚ûï Novo Aluno</button>
                </div>
                <div class="data-table">
                    <table id="studentsTable">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Turma</th>
                                <th>Infra√ß√µes</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Classes Tab -->
            <div id="tab-classes" class="tab-content">
                <div class="content-header">
                    <h2>Gest√£o de Turmas</h2>
                    <button class="btn btn--primary" id="addClassBtn">‚ûï Nova Turma</button>
                </div>
                <div class="classes-grid" id="classesGrid">
                </div>
            </div>

            <!-- Infractions Tab -->
            <div id="tab-infractions" class="tab-content">
                <div class="content-header">
                    <h2>Registro de Infra√ß√µes</h2>
                    <button class="btn btn--primary" id="addInfractionBtn">‚ûï Nova Infra√ß√£o</button>
                </div>
                <div class="filters">
                    <select class="form-control" id="filterClass">
                        <option value="">Todas as turmas</option>
                    </select>
                    <select class="form-control" id="filterType">
                        <option value="">Todos os tipos</option>
                        <option value="Atraso">Atraso</option>
                        <option value="Falta">Falta</option>
                        <option value="Comportamento">Comportamento</option>
                        <option value="Material">Material</option>
                    </select>
                    <select class="form-control" id="filterSeverity">
                        <option value="">Todas as gravidades</option>
                        <option value="leve">Leve</option>
                        <option value="media">M√©dia</option>
                        <option value="grave">Grave</option>
                    </select>
                </div>
                <div class="data-table">
                    <table id="infractionsTable">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Aluno</th>
                                <th>Turma</th>
                                <th>Tipo</th>
                                <th>Gravidade</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="infractionsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Filters Tab -->
            <div id="tab-filters" class="tab-content">
                <div class="section-header">
                    <h2>üîç Filtros e Consultas Avan√ßadas</h2>
                    <p>Sistema completo de filtros para an√°lise detalhada dos dados</p>
                </div>
                
                <div class="filters-grid">
                    <div class="filter-card">
                        <h3>üìÖ Filtros Temporais</h3>
                        <div class="filter-group">
                            <label class="form-label">Data Inicial:</label>
                            <input type="date" id="filterStartDate" class="form-control">
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Data Final:</label>
                            <input type="date" id="filterEndDate" class="form-control">
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Per√≠odo:</label>
                            <select id="filterPeriod" class="form-control">
                                <option value="">Selecione</option>
                                <option value="today">Hoje</option>
                                <option value="week">Esta Semana</option>
                                <option value="month">Este M√™s</option>
                                <option value="semester">Semestre</option>
                                <option value="year">Ano Letivo</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="filter-card">
                        <h3>‚öñÔ∏è Filtros por Gravidade</h3>
                        <div class="filter-checkboxes">
                            <label><input type="checkbox" value="leve" id="filterGravityLight"> üíö Leves</label>
                            <label><input type="checkbox" value="media" id="filterGravityMedium"> üü° M√©dias</label>
                            <label><input type="checkbox" value="grave" id="filterGravityHigh"> üî¥ Graves</label>
                        </div>
                    </div>
                    
                    <div class="filter-card">
                        <h3>üè´ Filtros por Turma</h3>
                        <select id="filterClassAdvanced" class="form-control">
                            <option value="">Todas as Turmas</option>
                        </select>
                    </div>
                    
                    <div class="filter-card">
                        <h3>üë®‚Äçüè´ Filtros por Respons√°vel</h3>
                        <select id="filterResponsible" class="form-control">
                            <option value="">Todos os Respons√°veis</option>
                        </select>
                    </div>
                </div>
                
                <div class="filter-actions">
                    <button onclick="applyFilters()" class="btn btn--primary">üîç Aplicar Filtros</button>
                    <button onclick="clearFilters()" class="btn btn--secondary">üßπ Limpar</button>
                    <button onclick="saveFilterPreset()" class="btn btn--info">üíæ Salvar Preset</button>
                </div>
                
                <div class="filtered-results">
                    <div id="filterResults" class="results-container"></div>
                    <div class="results-actions">
                        <button onclick="exportFilteredData('pdf')" class="btn btn--primary">üìÑ Gerar PDF</button>
                        <button onclick="exportFilteredData('excel')" class="btn btn--success">üìä Exportar Excel</button>
                        <button onclick="printFilteredResults()" class="btn btn--info">üñ®Ô∏è Imprimir</button>
                    </div>
                </div>
            </div>

            <!-- Statistics Tab -->
            <!-- Moved Statistics content into overview tab: Stats tab removed -->

            <!-- Reports Tab -->
            <div id="tab-reports" class="tab-content">
                <div class="content-header">
                    <h2>üìã Sistema de Relat√≥rios Educacionais</h2>
                </div>

                <div class="report-filters">
                    <h3>Filtros para Relat√≥rios</h3>
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label class="form-label">Per√≠odo</label>
                            <select class="form-control" id="reportPeriod">
                                <option value="today">Hoje</option>
                                <option value="yesterday">Ontem</option>
                                <option value="thisWeek">Esta Semana</option>
                                <option value="lastWeek">Semana Passada</option>
                                <option value="thisMonth" selected>Este M√™s</option>
                                <option value="lastMonth">M√™s Passado</option>
                                <option value="thisSemester">Este Semestre</option>
                                <option value="thisYear">Este Ano</option>
                                <option value="custom">Per√≠odo Personalizado</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Gravidade</label>
                            <select class="form-control" id="reportGravity">
                                <option value="all">Todas as Gravidades</option>
                                <option value="leve">Apenas Leves</option>
                                <option value="media">Apenas M√©dias</option>
                                <option value="grave">Apenas Graves</option>
                                <option value="mediaGrave">M√©dias + Graves</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Turma</label>
                            <select class="form-control" id="reportClass">
                                <option value="all">Todas as Turmas</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Turno</label>
                            <select class="form-control" id="reportShift">
                                <option value="all">Todos os Turnos</option>
                                <option value="morning">Matutino</option>
                                <option value="afternoon">Vespertino</option>
                                <option value="night">Noturno</option>
                            </select>
                        </div>
                    </div>
                    <div id="customDateRange" class="custom-date-range hidden">
                        <div class="filter-group">
                            <label class="form-label">Data In√≠cio</label>
                            <input type="date" class="form-control" id="reportStartDate">
                        </div>
                        <div class="filter-group">
                            <label class="form-label">Data Fim</label>
                            <input type="date" class="form-control" id="reportEndDate">
                        </div>
                    </div>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <h3>üìÑ Advert√™ncia Individual</h3>
                        <p>Gera relat√≥rio educacional completo com valores da escola e texto pedag√≥gico edit√°vel</p>
                        <div class="report-actions">
                            <select class="form-control" id="studentForReport">
                                <option value="">Selecione o aluno</option>
                            </select>
                            <button class="btn btn--primary" onclick="generateWarningReport()">üìÑ Gerar Advert√™ncia</button>
                        </div>
                    </div>
                    <div class="report-card">
                        <h3>üë§ Hist√≥rico do Aluno</h3>
                        <p>Relat√≥rio completo do hist√≥rico disciplinar individual</p>
                        <div class="report-actions">
                            <select class="form-control" id="studentForHistory">
                                <option value="">Selecione o aluno</option>
                            </select>
                            <button class="btn btn--secondary" onclick="generateStudentHistory()">üìö Gerar Hist√≥rico</button>
                        </div>
                    </div>
                    <div class="report-card">
                        <h3>üè´ Relat√≥rio por Turma</h3>
                        <p>Desempenho disciplinar consolidado da turma</p>
                        <button class="btn btn--secondary" onclick="generateClassReport()">üè´ Gerar por Turma</button>
                    </div>
                    <div class="report-card">
                        <h3>üìä Relat√≥rio Geral</h3>
                        <p>Relat√≥rio estat√≠stico geral com todos os filtros aplicados</p>
                        <button class="btn btn--secondary" onclick="generateGeneralReport()">üìä Gerar Geral</button>
                    </div>
                    <div class="report-card">
                        <h3>üìà Relat√≥rio Estat√≠stico</h3>
                        <p>An√°lise detalhada com gr√°ficos e indicadores</p>
                        <button class="btn btn--secondary" onclick="generateStatisticalReport()">üìà Gerar Estat√≠stico</button>
                    </div>
                    <div class="report-card">
                        <h3>üìÖ Relat√≥rio por Per√≠odo</h3>
                        <p>Infra√ß√µes no per√≠odo selecionado com an√°lise temporal</p>
                        <button class="btn btn--secondary" onclick="generatePeriodReport()">üìÖ Gerar por Per√≠odo</button>
                    </div>
                    <div class="report-card">
                        <h3>üö® Suspens√£o do Aluno</h3>
                        <p>Gera comunicado formal de suspens√£o conforme as regras de reincid√™ncia</p>
                        <div class="report-actions">
                            <select class="form-control" id="studentForSuspension">
                                <option value="">Selecione o aluno</option>
                            </select>
                            <button class="btn btn--danger" onclick="app.openManualSuspensionModal()">üö® Gerar Suspens√£o</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Settings Tab -->
            <div id="tab-settings" class="tab-content">
                <div class="section-header">
                    <h2>‚öôÔ∏è Configura√ß√µes</h2>
                    <p>Gerencie convites de acesso, permiss√µes e personaliza√ß√£o de relat√≥rios.</p>
                </div>
                <div class="settings-section">
                    <h3>Convites de Acesso</h3>
                    <p>Gere c√≥digos de convite para novos usu√°rios. Apenas quem possuir um c√≥digo v√°lido poder√° acessar o sistema ap√≥s o login pelo Google.</p>
                    <button id="generateInviteBtn" class="btn btn--primary">‚ûï Gerar Convite</button>
                    <div id="invitesList" class="invites-list"></div>
                </div>
                <div class="settings-section">
                    <h3>Usu√°rios Autorizados</h3>
                    <p>Lista de usu√°rios com acesso ao sistema. O primeiro usu√°rio cadastrado √© automaticamente definido como administrador.</p>
                    <div id="allowedUsersList" class="users-list"></div>
                </div>
                <div class="settings-section">
                    <h3>Personaliza√ß√£o de Relat√≥rios</h3>
                    <div class="form-group">
                        <label class="form-label">Cabe√ßalho dos Relat√≥rios</label>
                        <textarea id="reportHeaderInput" class="form-control" rows="2" placeholder="Ex: Escola Municipal de Lagarto"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Texto Pedag√≥gico Padr√£o</label>
                        <textarea id="defaultPedagogicalTextInput" class="form-control" rows="4" placeholder="Texto padr√£o a ser usado nos relat√≥rios de advert√™ncia..."></textarea>
                    </div>
                    <button id="saveSettingsBtn" class="btn btn--success">üíæ Salvar Configura√ß√µes</button>
                </div>

                <!-- Se√ß√£o de Personaliza√ß√£o de Tema - vis√≠vel para todos os usu√°rios -->
                <div class="settings-section">
                    <h3>Personaliza√ß√£o de Tema</h3>
                    <p>Escolha uma das paletas de cores para personalizar a apar√™ncia do sistema. Essa configura√ß√£o √© salva apenas para o seu dispositivo.</p>
                    <div class="form-group">
                        <label class="form-label" for="themeSelect">Paleta de Cores</label>
                        <select id="themeSelect" class="form-control">
                            <option value="default">Padr√£o</option>
                            <option value="blue">Azul</option>
                            <option value="green">Verde</option>
                            <option value="purple">Roxo</option>
                            <option value="orange">Laranja</option>
                        </select>
                    </div>
                    <button id="saveThemeBtn" class="btn btn--primary">üé® Aplicar Tema</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Novo Aluno -->
    <div id="studentModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>Cadastrar Novo Aluno</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <form id="studentForm">
                    <div class="form-group">
                        <label class="form-label">Nome Completo</label>
                        <input type="text" class="form-control" id="studentName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Turma</label>
                        <select class="form-control" id="studentClass" required>
                            <option value="">Selecione uma turma</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Matr√≠cula</label>
                        <input type="text" class="form-control" id="studentId" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Turno</label>
                        <select class="form-control" id="studentShift" required>
                            <option value="">Selecione o turno</option>
                            <option value="morning">Matutino</option>
                            <option value="afternoon">Vespertino</option>
                            <option value="night">Noturno</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelStudentBtn">Cancelar</button>
                <button class="btn btn--primary" id="saveStudentBtn">üíæ Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nova Turma -->
    <div id="classModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>Cadastrar Nova Turma</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <form id="classForm">
                    <div class="form-group">
                        <label class="form-label">Nome da Turma</label>
                        <input type="text" class="form-control" id="className" placeholder="Ex: 7¬∫ Ano A" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ano Letivo</label>
                        <input type="number" class="form-control" id="classYear" value="2024" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Professor Respons√°vel</label>
                        <input type="text" class="form-control" id="classTeacher" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Turno</label>
                        <select class="form-control" id="classShift" required>
                            <option value="">Selecione o turno</option>
                            <option value="morning">Matutino</option>
                            <option value="afternoon">Vespertino</option>
                            <option value="night">Noturno</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelClassBtn">Cancelar</button>
                <button class="btn btn--primary" id="saveClassBtn">üíæ Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nova Infra√ß√£o -->
    <div id="infractionModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>Registrar Nova Infra√ß√£o</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <form id="infractionForm">
                    <div class="form-group">
                        <label class="form-label">Aluno</label>
                        <select class="form-control" id="infractionStudent" required>
                            <option value="">Selecione um aluno</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Infra√ß√£o</label>
                        <select class="form-control" id="infractionType" required>
                            <option value="">Selecione o tipo</option>
                            <option value="Atraso">Atraso</option>
                            <option value="Falta">Falta</option>
                            <option value="Comportamento">Comportamento</option>
                            <option value="Material">Material</option>
                            <option value="Uniforme">Uniforme</option>
                            <option value="Disciplina">Disciplina</option>
                            <option value="Respeito">Desrespeito</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Gravidade</label>
                        <select class="form-control" id="infractionSeverity" required>
                            <option value="">Selecione a gravidade</option>
                            <option value="leve">Leve</option>
                            <option value="media">M√©dia</option>
                            <option value="grave">Grave</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Data</label>
                        <input type="date" class="form-control" id="infractionDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Hor√°rio</label>
                        <input type="time" class="form-control" id="infractionTime" required>
                    </div>
                    
                    <!-- NOVA SE√á√ÉO: Respons√°vel pela Observa√ß√£o -->
                    <div class="form-group">
                        <label class="form-label">üëÅÔ∏è Respons√°vel pela Observa√ß√£o da Infra√ß√£o</label>
                        <select class="form-control" id="responsibleType" onchange="updateResponsibleOptions()">
                            <option value="">Selecione o tipo</option>
                            <option value="professor">üë®‚Äçüè´ Professor</option>
                            <option value="funcionario">üë®‚Äçüíº Funcion√°rio</option>
                            <option value="coordenacao">üë©‚Äçüíº Coordena√ß√£o</option>
                            <option value="direcao">üèõÔ∏è Dire√ß√£o</option>
                        </select>
                    </div>
                    
                    <div id="responsibleDetails" class="form-group hidden">
                        <label class="form-label">Nome Completo do Respons√°vel</label>
                        <input type="text" class="form-control" id="responsibleName" placeholder="Digite o nome completo">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Descri√ß√£o Detalhada</label>
                        <textarea class="form-control" id="infractionDescription" rows="3" placeholder="Descreva detalhadamente o ocorrido..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Medidas Pedag√≥gicas</label>
                        <textarea class="form-control" id="infractionMeasures" rows="2" placeholder="Medidas aplicadas ou orienta√ß√µes dadas..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelInfractionBtn">Cancelar</button>
                <button class="btn btn--primary" id="saveInfractionBtn">üíæ Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Texto Pedag√≥gico -->
    <div id="pedagogicalTextModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>üìù Editar Texto Pedag√≥gico</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <div class="form-group">
                    <label class="form-label">üéì Texto Educacional da Escola</label>
                    <textarea class="form-control" id="pedagogicalText" rows="10" placeholder="Digite aqui o texto pedag√≥gico personalizado...">Nossa escola √© um ambiente que preza pela EDUCA√á√ÉO INTEGRAL, formando n√£o apenas estudantes, mas CIDAD√ÉOS CONSCIENTES e PESSOAS DE CAR√ÅTER.

A EDUCA√á√ÉO √© um processo colaborativo que exige a PARCERIA ATIVA entre escola e fam√≠lia. Nossa institui√ß√£o acredita que:

‚Ä¢ A ESCOLA √© respons√°vel pela forma√ß√£o acad√™mica e desenvolvimento de valores
‚Ä¢ A FAM√çLIA √© a base fundamental para o desenvolvimento do car√°ter
‚Ä¢ A PARCERIA entre ambas fortalece o processo educativo
‚Ä¢ O DI√ÅLOGO constante √© essencial para o sucesso do aluno</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìù Observa√ß√µes Adicionais Espec√≠ficas</label>
                    <textarea class="form-control" id="additionalObservations" rows="4" placeholder="Adicione observa√ß√µes espec√≠ficas sobre o aluno ou a situa√ß√£o..."></textarea>
                </div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="closePedagogicalModal()">Cancelar</button>
                <button class="btn btn--primary" onclick="updateReportText()">üíæ Atualizar Texto</button>
            </div>
        </div>
    </div>
    <!-- Modal para C√≥digo de Acesso -->
    <div id="accessCodeModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>üîê C√≥digo de Acesso Necess√°rio</h3>
            </div>
            <div class="modal__body">
                <p>Insira o c√≥digo de acesso fornecido pelo administrador para prosseguir:</p>
                <input type="text" id="accessCodeInput" class="form-control" placeholder="Digite o c√≥digo de acesso">
                <div id="accessCodeError" class="error-text hidden">C√≥digo inv√°lido ou expirado.</div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelAccessCodeBtn">Cancelar</button>
                <button class="btn btn--primary" id="verifyAccessCodeBtn">Verificar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Selecionar Infra√ß√£o espec√≠fica ou relat√≥rio geral do aluno -->
    <div id="infractionSelectModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>Selecionar Infra√ß√£o ou Hist√≥rico Completo</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <p>>Escolha gerar um relat√≥rio completo com todas as ocorr√™ncias ou selecione uma infra√ß√£o espec√≠fica para uma advert√™ncia individual.</p>
                <div id="infractionSelectionList" class="selection-list"></div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelInfractionSelectionBtn">Cancelar</button>
                 <button class="btn btn--primary" id="confirmInfractionSelectionBtn">Gerar Relat√≥rio</button>
        </div>
    </div>

     <div id="suspensionModal" class="modal hidden">
        <div class="modal__content">
            <div class="modal__header">
                <h3>üö® Sugerir Suspens√£o</h3>
                <button class="modal__close">&times;</button>
            </div>
            <div class="modal__body">
                <p class="modal__subtitle"><strong id="suspensionStudentName"></strong></p>
                <p class="modal__description" id="suspensionReason"></p>
                <div id="suspensionCounts"></div>
                <div class="form-group">
                    <label class="form-label" for="suspensionDuration">Dura√ß√£o sugerida</label>
                    <select id="suspensionDuration" class="form-control">
                        <option value="1">1 dia</option>
                        <option value="3">3 dias</option>
                        <option value="5">5 dias</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suspensionLetterText">Texto do comunicado</label>
                    <textarea id="suspensionLetterText" class="form-control" rows="6" placeholder="Descreva o comunicado para a fam√≠lia"></textarea>
                </div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelSuspensionBtn">Cancelar</button>
                <button class="btn btn--danger" id="generateSuspensionBtn">üö® Gerar Suspens√£o</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="app.js"></script>
</body>
</html>
